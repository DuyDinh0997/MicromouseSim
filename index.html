<html>

<head>
	<title>Micromouse Simulator</title>

	<link rel="stylesheet" href="main.css" type="text/css">
</head>


<body>

<h2>Micromouse Simulator <a class="small_link" href="https://github.com/bblodget">Source on GitHub</a></h2>


<div id="maze_div">
<form>
<span class="heading">Maze</span>

<div class="select">
<label for="maze_sel">Select Maze (<a href="http://www.tcp4me.com/mmr/mazes/">source url</a>)</label>
<select name="maze_sel" id="maze_sel">
  <option value="1">00japan</option>
  <option value="2">1stworld</option>
  <option value="3">80japx</option>
  <option value="4">81japx</option>
  <option value="5">82japx</option>
  <option value="6">82us</option>
  <option value="7">82japx</option>
  <option value="8">83japx</option>
  <option value="9">83us</option>
  <option value="10">84japx</option>
  <option value="11">85japx</option>
  <option value="12">85usa</option>
  <option value="13">86</option>
  <option value="14">86chi</option>
  <option value="15">86jap</option>
  <option value="16">86japx</option>
  <option value="17">87iee</option>
  <option value="18">87jap</option>
  <option value="19">87japx</option>
  <option value="20">87sin</option>
  <option value="21">87us1</option>
  <option value="22">88iee</option>
  <option value="23">88jap</option>
  <option value="24">88japx</option>
  <option value="25">88lon</option>
  <option value="26">88mtl</option>
  <option value="27">88sin</option>
  <option value="28">88us</option>
  <option value="29">89ape</option>
  <option value="30">89iee</option>
  <option value="31">89japa1</option>
  <option value="32">89japa2</option>
  <option value="33">89japx</option>
  <option value="34">89lon</option>
  <option value="35">89lonq</option>
  <option value="36">89sina1</option>
  <option value="37">90japx</option>
  <option value="38">90lon</option>
  <option value="39">90lonq</option>
  <option value="40">90tor</option>
  <option value="41">91hon</option>
  <option value="42">91japa1</option>
  <option value="43">91japq</option>
  <option value="44">91japx</option>
  <option value="45">91lon</option>
  <option value="46">91tor</option>
  <option value="47">92bos</option>
  <option value="48">92japx</option>
  <option value="49">92lon</option>
  <option value="50">92lonq</option>
  <option value="51">93apec</option>
  <option value="52">93japx</option>
  <option value="53">94beam1</option>
  <option value="54">94beam2</option>
  <option value="55">94japan</option>
  <option value="56">94japx</option>
  <option value="57">95japx</option>
  <option value="58">96japx</option>
  <option value="59">97japx</option>
  <option value="60">j1</option>
  <option value="61">j2</option>
  <option value="62">j3</option>
  <option value="63">j4</option>
  <option value="64">j5</option>
  <option value="65">j6</option>
  <option value="66">loop</option>
  <option value="67">museum</option>
  <option value="68">test1</option>
  <option value="69">zigzag</option>
</select>
</div>

<canvas id="maze" width="512" height="512"> </canvas>

<div id="maze_controls_div">
<button id = "home" type="button">Home</button>
<button id = "start_stop" type="button">Start</button>
<button id = "step" type="button">Step</button>
</div>
</form>
</div>

<div id="driver_div">
<form>
<span class="heading">Mouse Algorithm</span>

<div class="select">
<label for="driver_sel">Select Template (<a href="https://github.com/bblodget/MicroMouseSim/wiki/Mouse-API">Mouse API</a>)</label>
<select name="driver_sel" id="driver_sel">
  <option value="right_wall">Right Wall Follower</option>
  <option value="left_wall">Left Wall Follower</option>
</select>
</div>

<textarea id="driver_code" rows=30> 
</textarea>

<div id="code_controls_div">
<button id="download" type="button">Download to mouse</button>
</div>

</form>

</div>



</body>

<script type="text/javascript" src="jquery-1.5.2.min.js"></script>
<script type="text/javascript" src="maze.js"></script>
<script type="text/javascript" src="driver.js"></script>

<script type="text/javascript">
jQuery(function() {

	$('#driver_code').change(
		function(event) {
			$("#download").attr("disabled",false);
		}
	);

	$('#download').click(
		function(event) {
			var code = $("#driver_code").val();
			jQuery.globalEval(code);
			mouse.loadDriver(driver);
			mouse.home();
			// $("#download").attr("disabled",true);
		}
	);

	$('#start_stop').click(
		function(event) {
			if ($('#start_stop').html() === 'Start') {
				mouse.start();
				$('#start_stop').html('Stop');

			} else {
				mouse.stop();
				$('#start_stop').html('Start');
			}
		}
	);

	$('#maze_sel').change(
		function(event) {
			mouse.loadMaze($('#maze_sel option:selected').text());
		}
	);

	$('#driver_sel').change(
		function(event) {
			var template_file = "templates/" + 
				$('#driver_sel option:selected').val() + ".js";
			$('#driver_code').load(template_file);

			mouse.loadDriver(driver);
		}
	);

	$('#step').click(mouse.step);
	$('#home').click(mouse.home);

	// load driver code from template
	var template_file = "templates/" + 
		$('#driver_sel option:selected').val() + ".js";
	$('#driver_code').load(template_file);

	// select random maze
	var last_opt = $('#maze_sel option:last').val();
	var rand_maze = Math.floor(Math.random()*last_opt+1)
	$("#maze_sel").val(rand_maze).attr('selected','selected');
	var maze_sel = $('#maze_sel option:selected').text();


	mouse.newMaze($('#start_stop'),maze_sel);
	mouse.loadDriver(driver);

	var maze_height = $("canvas#maze").height() + 8;
	// console.log("maze_height: " + maze_height);
	$("#driver_div").height(maze_height);

});
</script>



</html>
